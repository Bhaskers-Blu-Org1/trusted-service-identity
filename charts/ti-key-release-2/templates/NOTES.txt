This helm chart installs environment for Trusted Identity
  Namespace enabled: {{ index .Values "ti-key-release-1" "namespace" }}

  app: {{ template "ti-key-release.name" . }}
  chart: {{ template "ti-key-release.chart" . }}
  release: {{ .Release.Name }}

  # Typically, the sub-chart values should be retrieved directly,
  # however, there is a problem with retrieving values that contain "-"
  # see the helm issue: https://github.com/helm/helm/issues/2192
  This chart tiVersion: {{ .Values.tiVersion }}
  Sub-chart (ti-key-release-1) tiVersion: {{ index .Values "ti-key-release-1" "tiVersion" }}

    vaultAddress: {{ index .Values "ti-key-release-1" "vaultAddress" }}
    cluster.name: {{ index .Values "ti-key-release-1" "cluster" "name" }}
    cluster.region: {{ index .Values "ti-key-release-1" "cluster" "region" }}
    jwt.expireSec: {{ index .Values "ti-key-release-1" "jwt" "expireSec" }}
    createVaultCert: {{ index .Values "ti-key-release-1" "createVaultCert" }}

  vTPM service is available from any container in the {{ index .Values "ti-key-release-1" "namespace" }} namespace
  To get JWKS (to be depricated):
    curl http://{{ index .Values "ti-key-release-1" "vtpmService" "name" }}:{{ index .Values "ti-key-release-1" "vtpmService" "port" }}/getJWKS
  To get CSR:
    curl http://{{ index .Values "ti-key-release-1" "vtpmService" "name" }}:{{ index .Values "ti-key-release-1" "vtpmService" "port" }}/public/getCSR

  Ingress allows a public access to vTPM CSR:
    curl http://{{ index .Values "ti-key-release-1" "ingress" "host" }}{{ index .Values "ti-key-release-1" "ingress" "path" }}public/getCSR

Execute test:
  kubectl create -f examples/myubuntu.yaml -n trusted-identity
